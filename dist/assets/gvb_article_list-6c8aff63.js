import{u as F,e as S}from"./article_api-6b276102.js";import{i as q}from"./image_api-a257d8a1.js";import{_ as H}from"./gvb_table-a7f3b8bc.js";import{a as J}from"./tag_api-99bf4aac.js";import{b as R,a as z,r as f,c as w,d as v,o as l,e as r,i as x,j as c,f as o,w as i,l as K,h as d,t as u,F as W,k as Y,m as A}from"./index-a4ff3a35.js";import{_ as G}from"./gvb_article_modal-8a09037f.js";const P={key:0},Q=["innerHTML"],X=["src"],Z={key:3,class:"gvb_article_data"},tt={key:4,class:"gvb_article_abstract"},et={key:5,class:"gvb_article_tags"},rt={__name:"gvb_article_list",props:{baseUrl:{type:String,default:"/api/articles"}},setup(L){const V=L,y=R(),h=z(),m=f(null),b=f(null),k=f(null),_=w({tagOptions:[],categoryOptions:[],imageOptions:[]}),e=w({list:[{abstract:"这是一条a'a'aaaa请求",banner_id:1,banner_url:"uploads/file/checken_logo.png",category:"python",collects_count:0,comment_count:0,created_at:"2023-05-03 15:00:32",digg_count:0,id:"aWRp4IcBBgJj1CYJpMIt",look_count:0,tags:["python","后端","前端","python","后端","前端"],title:"python测试2",updated_at:"2023-05-03 15:00:32",user_avatar:"/uploads/avatar/default.jpg",user_id:2,user_nick_name:"zhangsan"}],columns:[{title:"Index",dataIndex:"index",key:"index"},{title:"文章标题",dataIndex:"title",key:"title"},{title:"文章分类",dataIndex:"category",key:"category"},{title:"文章简介",dataIndex:"abstract",key:"abstract"},{title:"作者",dataIndex:"user_nick_name",key:"user_nick_name"},{title:"封面",dataIndex:"banner_url",key:"banner_url"},{title:"文章数据",dataIndex:"data",key:"data"},{title:"标签",dataIndex:"tags",key:"tags"},{title:"发布时间",dataIndex:"created_at",key:"created_at"},{title:"操作",dataIndex:"action",key:"action"}],tagOptions:[],categoryOptions:[],imageOptions:[],editVisible:!1,state:{title:"",abstract:"",banner_id:null,category:"",link:"",source:"",tags:[]},editID:""});function T(t){e.state.title=t.title,e.state.abstract=t.abstract,e.state.banner_id=t.banner_id,e.state.category=t.category,e.state.link=t.link,e.state.source=t.source,e.state.tags=t.tags,e.editID=t.id,e.editVisible=!0}function D(t){h.push({name:"edit_article",params:{id:t.id},query:{title:t.title}}),y.addTab({name:"edit_article",title:"编辑文章",params:{id:t.id},query:{title:t.title}})}const B=["red","blue","green","purple","cyan","orange","pink"];function E(t){return B[t]}async function M(t){let s=await F(e.editID,t);if(s.code){A.error(s.msg);return}A.success(s.msg),e.editVisible=!1,k.value.ExportList()}function N(){h.push({name:"add_article"}),y.addTab({name:"add_article",title:"添加文章"})}function I(){k.value.ExportList({tag:m.value,key:b.value})}async function U(){let t=await J();_.tagOptions=t.data;let s=await S();_.categoryOptions=s.data;let p=await q();_.imageOptions=p.data}return U(),(t,s)=>{const p=v("a-button"),g=v("a-tag"),C=v("a-select");return l(),r("div",null,[e.editVisible?(l(),x(G,{key:0,visible:e.editVisible,"onUpdate:visible":s[0]||(s[0]=a=>e.editVisible=a),state:e.state,"init-data-state":_,"is-edit":"",onOk:M},null,8,["visible","state","init-data-state"])):c("",!0),o(H,{columns:e.columns,"base-url":V.baseUrl,list:e.list,"like-title":"搜索文章标题",ref_key:"gvbTable",ref:k,"default-delete":""},{add:i(()=>[K(y).userInfo.role!==2?(l(),x(p,{key:0,type:"primary",onClick:N},{default:i(()=>[d("添加")]),_:1})):c("",!0)]),edit:i(({record:a})=>[o(p,{type:"primary",onClick:n=>T(a)},{default:i(()=>[d("编辑")]),_:2},1032,["onClick"]),o(p,{type:"primary",onClick:n=>D(a)},{default:i(()=>[d("正文编辑")]),_:2},1032,["onClick"])]),cell:i(({column:a,record:n,index:$})=>[a.key==="index"?(l(),r("span",P,u($+1),1)):c("",!0),a.key==="title"?(l(),r("span",{key:1,class:"gvb_article_title",innerHTML:n.title},null,8,Q)):c("",!0),a.key==="banner_url"?(l(),r("img",{key:2,src:n.banner_url,alt:"",height:"60",style:{"border-radius":"5px"}},null,8,X)):c("",!0),a.key==="data"?(l(),r("div",Z,[o(g,{class:"fa fa-eye"},{default:i(()=>[d(u(n.look_count),1)]),_:2},1024),o(g,{class:"fa fa-thumbs-o-up"},{default:i(()=>[d(u(n.digg_count),1)]),_:2},1024),o(g,{class:"fa fa-comment-o"},{default:i(()=>[d(u(n.comment_count),1)]),_:2},1024),o(g,{class:"fa fa-star-o"},{default:i(()=>[d(u(n.collects_count),1)]),_:2},1024)])):c("",!0),a.key==="abstract"?(l(),r("div",tt,u(n.abstract),1)):c("",!0),a.key==="tags"?(l(),r("div",et,[(l(!0),r(W,null,Y(n.tags,(j,O)=>(l(),x(g,{color:E(O),key:O},{default:i(()=>[d(u(j),1)]),_:2},1032,["color"]))),128))])):c("",!0)]),filters:i(()=>[o(C,{class:"gvb_select",value:m.value,"onUpdate:value":s[1]||(s[1]=a=>m.value=a),style:{width:"200px"},allowClear:"",onChange:I,options:_.tagOptions,placeholder:"筛选文章标签"},null,8,["value","options"]),o(C,{class:"gvb_select",value:b.value,"onUpdate:value":s[2]||(s[2]=a=>b.value=a),style:{width:"200px"},allowClear:"",onChange:I,options:_.categoryOptions,placeholder:"筛选文章分类"},null,8,["value","options"])]),_:1},8,["columns","base-url","list"])])}}};export{rt as _};
