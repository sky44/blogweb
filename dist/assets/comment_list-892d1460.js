import{_ as L}from"./gvb_table-5acee8a1.js";import{a as U,r as v,c as A,d as o,o as s,e as _,f as l,w as a,m as r,h as u,j as p,F as B,i as E}from"./index-60e5bf44.js";import{c as N,a as V}from"./comment_api-a633d422.js";import{f as q}from"./article_api-61275ba2.js";import"./date-d051bfca.js";const F=["src"],J={__name:"comment_list",setup($){U();const c=v(null),f=v(null),e=A({list:[],columns:[{title:"id",dataIndex:"id",key:"id"},{title:"文章标题",dataIndex:"article_title",key:"article_title"},{title:"文章封面",dataIndex:"article_banner",key:"article_banner"},{title:"父评论id",dataIndex:"parent_comment_id",key:"parent_comment_id"},{title:"评论内容",dataIndex:"content",key:"content"},{title:"点赞数",dataIndex:"digg_count",key:"digg_count"},{title:"评论数",dataIndex:"comment_count",key:"comment_count"},{title:"评论人昵称",dataIndex:"user_nick_name",key:"user_nick_name"},{title:"评论时间",dataIndex:"created_at",key:"created_at"},{title:"操作",dataIndex:"action",key:"action"}],visible:!1,state:{article_id:null,content:"",parent_comment_id:null},articleIDTitleList:[]});async function k(i){let n=await V(i.id);if(n.code){r.error(n.msg);return}r.success(n.msg),c.value.ExportList()}function y(){g(),e.visible=!0}async function g(){let i=await q();e.articleIDTitleList=i.data}async function x(){try{await f.value.validate()}catch{return}let i=await N(e.state);if(i.code){r.error(i.msg);return}r.success(i.msg),e.state.content="",e.visible=!1,c.value.ExportList()}return(i,n)=>{const I=o("a-select"),m=o("a-form-item"),w=o("a-textarea"),h=o("a-input-number"),C=o("a-form"),R=o("a-modal"),b=o("a-button"),T=o("a-tag"),D=o("a-popconfirm");return s(),_("div",null,[l(R,{title:"发布评论",visible:e.visible,"onUpdate:visible":n[3]||(n[3]=t=>e.visible=t),onOk:x},{default:a(()=>[l(C,{model:e.state,name:"basic",ref_key:"formRef",ref:f,"label-col":{span:4},"wrapper-col":{span:18},autocomplete:"off"},{default:a(()=>[l(m,{label:"文章",name:"article_id","has-feedback":"",rules:[{required:!0,message:"请选择文章",trigger:"blur"}]},{default:a(()=>[l(I,{class:"gvb_select",value:e.state.article_id,"onUpdate:value":n[0]||(n[0]=t=>e.state.article_id=t),style:{width:"200px"},allowClear:"",options:e.articleIDTitleList,placeholder:"选择文章"},null,8,["value","options"])]),_:1}),l(m,{label:"评论内容",name:"content","has-feedback":"",rules:[{required:!0,message:"请输入评论内容",trigger:"blur"}]},{default:a(()=>[l(w,{placeholder:"评论内容",value:e.state.content,"onUpdate:value":n[1]||(n[1]=t=>e.state.content=t),class:"content","auto-size":{minRows:2,maxRows:5}},null,8,["value"])]),_:1}),l(m,{label:"父评论id",name:"parent_comment_id","has-feedback":""},{default:a(()=>[l(h,{placeholder:"评论内容",value:e.state.parent_comment_id,"onUpdate:value":n[2]||(n[2]=t=>e.state.parent_comment_id=t)},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["visible"]),l(L,{columns:e.columns,"base-url":"/api/comments_all","like-title":"搜索评论内容","is-batch-delete":!1,"is-edit":!1,"is-select":!1,ref_key:"gvbTable",ref:c,"default-delete":""},{add:a(()=>[l(b,{type:"primary",onClick:y},{default:a(()=>[u("添加")]),_:1})]),edit:a(({record:t})=>[]),cell:a(({column:t,record:d,index:j})=>[t.key==="article_banner"?(s(),_("img",{key:0,src:d.article_banner,alt:"",height:"60",style:{"border-radius":"5px"}},null,8,F)):p("",!0),t.key==="parent_comment_id"?(s(),_(B,{key:1},[d.parent_comment_id===null?(s(),E(T,{key:0,color:"red"},{default:a(()=>[u(" 根评论 ")]),_:1})):p("",!0)],64)):p("",!0)]),delete:a(({record:t})=>[l(D,{title:"是否确定删除?","ok-text":"删除","cancel-text":"取消",onConfirm:d=>k(t)},{default:a(()=>[l(b,{class:"gvb_table_action delete",type:"primary",danger:""},{default:a(()=>[u("删除")]),_:1})]),_:2},1032,["onConfirm"])]),_:1},8,["columns"])])}}};export{J as default};
