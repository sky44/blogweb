import{_ as N}from"./gvb_table-5acee8a1.js";import{a as U}from"./image_api-bab7cfc5.js";import{b as B,r as _,c as b,d as n,o as v,e as y,f as i,w as a,m as g,l as E,g as r,h as k,j as R}from"./index-60e5bf44.js";import"./date-d051bfca.js";const T=r("i",{class:"fa fa-cloud-upload"},null,-1),$=r("div",{style:{"margin-left":"5px"}},"上传图片",-1),O=["src"],S=["src"],D={__name:"image_list",setup(j){const x=B(),d=_(null),m=_(null),e=b({columns:[{title:"id",dataIndex:"id",key:"id"},{title:"图片名称",dataIndex:"name",key:"name"},{title:"图片预览",dataIndex:"path",key:"path"},{title:"类型",dataIndex:"image_type",key:"image_type"},{title:"上传时间",dataIndex:"created_at",key:"created_at"},{title:"操作",dataIndex:"action",key:"action"}],visible:!1,modalVisible:!1,fileList:[]}),o=b({id:0,name:"",path:""});function h(s){e.modalVisible=!0,o.id=s.id,o.name=s.name,o.path=s.path}async function V(){try{await m.value.validate();let s=await U(o);if(s.code){g.error(s.msg);return}g.success(s.msg),e.modalVisible=!1,d.value.ExportList()}catch{}}function C(){e.visible=!1,d.value.ExportList(),e.fileList=[]}return(s,l)=>{const I=n("a-upload"),u=n("a-modal"),L=n("a-input"),p=n("a-form-item"),w=n("a-form"),f=n("a-button");return v(),y("div",null,[i(u,{title:"上传图片",visible:e.visible,"onUpdate:visible":l[1]||(l[1]=t=>e.visible=t),onOk:C},{default:a(()=>[i(I,{"file-list":e.fileList,"onUpdate:fileList":l[0]||(l[0]=t=>e.fileList=t),action:"/api/images","list-type":"picture-card",name:"images",multiple:"",headers:{token:E(x).userInfo.token}},{default:a(()=>[T,$]),_:1},8,["file-list","headers"])]),_:1},8,["visible"]),i(u,{title:"编辑图片",visible:e.modalVisible,"onUpdate:visible":l[3]||(l[3]=t=>e.modalVisible=t),onOk:V},{default:a(()=>[i(w,{model:o,name:"basic",ref_key:"formRef",ref:m,"label-col":{span:4},"wrapper-col":{span:20},autocomplete:"off"},{default:a(()=>[i(p,{label:"文件名称",name:"name","has-feedback":"",rules:[{required:!0,message:"请输入文件名",trigger:"blur"}]},{default:a(()=>[i(L,{value:o.name,"onUpdate:value":l[2]||(l[2]=t=>o.name=t),placeholder:"用户名"},null,8,["value"])]),_:1}),i(p,{label:"图片预览"},{default:a(()=>[r("img",{src:o.path,height:"80",style:{"border-radius":"5px"},alt:""},null,8,O)]),_:1})]),_:1},8,["model"])]),_:1},8,["visible"]),i(N,{columns:e.columns,"base-url":"/api/images","like-title":"搜索图片名称",ref_key:"gvbTable",ref:d,"default-delete":""},{add:a(()=>[i(f,{type:"primary",onClick:l[4]||(l[4]=t=>e.visible=!0)},{default:a(()=>[k("添加")]),_:1})]),edit:a(({record:t})=>[i(f,{type:"primary",onClick:c=>h(t)},{default:a(()=>[k("编辑")]),_:2},1032,["onClick"])]),cell:a(({column:t,record:c})=>[t.key==="path"?(v(),y("img",{key:0,src:c.path,alt:"",height:"60",style:{"border-radius":"5px"}},null,8,S)):R("",!0)]),_:1},8,["columns"])])}}};export{D as default};
