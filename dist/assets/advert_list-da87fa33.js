import{_ as O}from"./gvb_table-a7f3b8bc.js";import{u as q,c as L}from"./advert_api-ef7abe09.js";import{r as p,c as w,d as r,o as u,e as g,f as l,w as a,m as x,l as R,g as T,h as c,j as h,F as D,i as b,t as E}from"./index-a4ff3a35.js";import"./date-d051bfca.js";const F=["src"],M=["src"],G={__name:"advert_list",setup(P){const v=p(null),I=p(null),o=p(0),k={href:"",images:"",is_show:!0,title:""},e=w({href:"",images:"",is_show:!0,title:""});let U=async(s,i)=>{try{return new URL(i),Promise.resolve()}catch{return Promise.reject("不合法的url")}};const n=w({columns:[{title:"id",dataIndex:"id",key:"id"},{title:"广告标题",dataIndex:"title",key:"title"},{title:"图片路径",dataIndex:"images",key:"images"},{title:"跳转地址",dataIndex:"href",key:"href"},{title:"是否显示",dataIndex:"is_show",key:"is_show"},{title:"添加时间",dataIndex:"created_at",key:"created_at"},{title:"操作",dataIndex:"action",key:"action"}],visible:!1,modalVisible:!1,fileList:[]});async function C(){let s;if(console.log(o),o.value!==0?s=await q(o.value,e):s=await L(e),s.code){x.error(s.msg);return}x.success(s.msg),n.visible=!1,Object.assign(e,k),v.value.ExportList()}function V(s){console.log("update",e),o.value=s.id,e.title=s.title,e.href=s.href,e.images=s.images,e.is_show=s.is_show,n.visible=!0}function j(){console.log("add",e),n.visible=!0,o.value=0,Object.assign(e,k)}return(s,i)=>{const f=r("a-input"),d=r("a-form-item"),A=r("a-switch"),B=r("a-form"),N=r("a-modal"),_=r("a-button"),y=r("a-tag");return u(),g("div",null,[l(N,{title:o.value?"编辑广告":"添加广告",visible:n.visible,"onUpdate:visible":i[4]||(i[4]=t=>n.visible=t),onOk:C},{default:a(()=>[l(B,{model:e,name:"basic",ref_key:"formRef",ref:I,"label-col":{span:4},"wrapper-col":{span:20},autocomplete:"off"},{default:a(()=>[l(d,{label:"广告名称",name:"title","has-feedback":"",rules:[{required:!0,message:"请输入广告名称",trigger:"blur"}]},{default:a(()=>[l(f,{value:e.title,"onUpdate:value":i[0]||(i[0]=t=>e.title=t),placeholder:"广告名称"},null,8,["value"])]),_:1}),l(d,{label:"广告链接",name:"href","has-feedback":"",rules:[{required:!0,message:"请输入广告链接",trigger:"blur"},{validator:R(U),message:"url不合法",trigger:"blur"}]},{default:a(()=>[l(f,{value:e.href,"onUpdate:value":i[1]||(i[1]=t=>e.href=t),placeholder:"广告链接"},null,8,["value"])]),_:1},8,["rules"]),l(d,{label:"图片地址",name:"images","has-feedback":"",rules:[{required:!0,message:"请输入图片地址",trigger:"blur"}]},{default:a(()=>[l(f,{value:e.images,"onUpdate:value":i[2]||(i[2]=t=>e.images=t),placeholder:"图片地址"},null,8,["value"])]),_:1}),l(d,{label:"是否显示",name:"is_show"},{default:a(()=>[l(A,{checked:e.is_show,"onUpdate:checked":i[3]||(i[3]=t=>e.is_show=t)},null,8,["checked"])]),_:1}),l(d,{label:"图片预览"},{default:a(()=>[T("img",{src:e.images,height:"60",style:{"border-radius":"5px"},alt:""},null,8,F)]),_:1})]),_:1},8,["model"])]),_:1},8,["title","visible"]),l(O,{columns:n.columns,"base-url":"/api/adverts","like-title":"搜索广告名称",ref_key:"gvbTable",ref:v,"default-delete":""},{add:a(()=>[l(_,{type:"primary",onClick:j},{default:a(()=>[c("添加")]),_:1})]),edit:a(({record:t})=>[l(_,{type:"primary",onClick:m=>V(t)},{default:a(()=>[c("编辑")]),_:2},1032,["onClick"])]),cell:a(({column:t,record:m})=>[t.key==="images"?(u(),g("img",{key:0,src:m.images,alt:"",height:"60",style:{"border-radius":"5px"}},null,8,M)):h("",!0),t.key==="is_show"?(u(),g(D,{key:1},[m.is_show?(u(),b(y,{key:0,color:"green"},{default:a(()=>[c("显示")]),_:1})):(u(),b(y,{key:1,color:"red"},{default:a(()=>[c("不显示")]),_:1}))],64)):h("",!0),t.key==="href"?(u(),b(_,{key:2,type:"link",target:"_blank",href:m.href},{default:a(()=>[c(E(m.href),1)]),_:2},1032,["href"])):h("",!0)]),_:1},8,["columns"])])}}};export{G as default};
